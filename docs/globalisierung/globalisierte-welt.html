<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Globalisierungs-Quiz - Weltkarten-Spiel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes route {
            0% { stroke-dashoffset: 1000; }
            100% { stroke-dashoffset: 0; }
        }
        
        .draggable {
            cursor: move;
            transition: transform 0.2s;
        }
        
        .draggable:hover {
            transform: scale(1.1);
        }
        
        .draggable.dragging {
            opacity: 0.5;
            transform: scale(1.2);
        }
        
        .drop-zone {
            transition: all 0.3s;
        }
        
        .drop-zone.drag-over {
            transform: scale(1.1);
            filter: brightness(1.2);
        }
        
        .drop-zone.correct {
            animation: pulse 0.5s ease-in-out;
        }
        
        .route-line {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: route 2s ease-in-out forwards;
        }
        
        .celebration {
            animation: bounce 0.5s ease-in-out 3;
        }
        
        #worldMap {
            max-width: 100%;
            height: auto;
        }
        
        .country-marker {
            cursor: pointer;
        }
        
        .country-marker circle {
            transition: r 0.2s, fill 0.2s;
        }
        
        .country-marker:hover circle {
            r: 3;
        }
        
        .country-label {
            pointer-events: none;
            user-select: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
    <div id="app"></div>

    <script>
        // Game State
        let gameState = {
            currentLevel: 0,
            score: 0,
            lives: 3,
            correctAnswers: 0,
            currentProduct: null,
            difficulty: 'easy', // easy, medium, hard
            gameMode: 'menu', // menu, playing, result, final
            currentQuestionIndex: 0,
            showHint: false
        };

        // Product data with quiz questions
        const products = {
            tshirt: {
                name: 'T-Shirt',
                icon: 'üëï',
                color: '#3B82F6',
                questions: [
                    {
                        question: 'Wo wird die Baumwolle f√ºr T-Shirts haupts√§chlich angebaut?',
                        options: ['Indien', 'Schweiz', 'Deutschland', 'Brasilien'],
                        correctCountry: 'Indien',
                        coordinates: { x: 64, y: 38 },
                        fact: 'Indien ist der zweitgr√∂√üte Baumwollproduzent der Welt! Ein einziges T-Shirt ben√∂tigt etwa 2.700 Liter Wasser.',
                        co2: '2.1 kg CO‚ÇÇ'
                    },
                    {
                        question: 'In welchem Land wird der Stoff oft gewebt und gef√§rbt?',
                        options: ['China', 'Italien', 'USA', 'Kanada'],
                        correctCountry: 'China',
                        coordinates: { x: 72, y: 34 },
                        fact: 'China ist die weltgr√∂√üte Textilindustrie. Beim F√§rben werden oft gro√üe Mengen Wasser verschmutzt.',
                        co2: '3.5 kg CO‚ÇÇ'
                    },
                    {
                        question: 'Wo werden viele T-Shirts zusammengen√§ht?',
                        options: ['Bangladesh', 'Norwegen', 'Australien', 'Mexiko'],
                        correctCountry: 'Bangladesh',
                        coordinates: { x: 67, y: 40 },
                        fact: 'Bangladesh ist eines der gr√∂√üten Textilproduktionsl√§nder. Viele Menschen arbeiten dort in der Bekleidungsindustrie.',
                        co2: '1.2 kg CO‚ÇÇ'
                    }
                ],
                route: [
                    { x: 64, y: 38 }, // Indien
                    { x: 72, y: 34 }, // China
                    { x: 67, y: 40 }, // Bangladesh
                    { x: 50, y: 28 }  // Schweiz
                ]
            },
            smartphone: {
                name: 'Smartphone',
                icon: 'üì±',
                color: '#8B5CF6',
                questions: [
                    {
                        question: 'Wo wird Coltan f√ºr Smartphone-Batterien oft abgebaut?',
                        options: ['Kongo', 'Gr√∂nland', 'Island', 'Argentinien'],
                        correctCountry: 'Kongo',
                        coordinates: { x: 52, y: 52 },
                        fact: 'Der Kongo besitzt 80% der weltweiten Coltan-Reserven. Dieser Rohstoff ist essentiell f√ºr Kondensatoren in Elektronik.',
                        co2: '15 kg CO‚ÇÇ'
                    },
                    {
                        question: 'In welchem Land werden die meisten Mikrochips produziert?',
                        options: ['Taiwan', 'Portugal', '√Ñgypten', 'Peru'],
                        correctCountry: 'Taiwan',
                        coordinates: { x: 74, y: 42 },
                        fact: 'Taiwan produziert √ºber 60% der weltweiten Mikrochips! Eine einzige Chip-Fabrik kostet mehrere Milliarden Dollar.',
                        co2: '25 kg CO‚ÇÇ'
                    },
                    {
                        question: 'Wo werden die meisten Smartphones zusammengebaut?',
                        options: ['China', 'Finnland', 'Spanien', 'S√ºdafrika'],
                        correctCountry: 'China',
                        coordinates: { x: 72, y: 34 },
                        fact: 'China ist die ‚ÄûWerkbank der Welt". Allein in Shenzhen werden t√§glich Hunderttausende Smartphones produziert.',
                        co2: '8 kg CO‚ÇÇ'
                    }
                ],
                route: [
                    { x: 52, y: 52 }, // Kongo
                    { x: 74, y: 42 }, // Taiwan
                    { x: 72, y: 34 }, // China
                    { x: 50, y: 28 }  // Schweiz
                ]
            },
            coffee: {
                name: 'Kaffee',
                icon: '‚òï',
                color: '#D97706',
                questions: [
                    {
                        question: 'Welches Land ist der gr√∂√üte Kaffeeproduzent der Welt?',
                        options: ['Brasilien', 'Schweiz', 'Russland', 'Indien'],
                        correctCountry: 'Brasilien',
                        coordinates: { x: 32, y: 58 },
                        fact: 'Brasilien produziert etwa ein Drittel des weltweiten Kaffees! Die Ernte erfolgt oft noch von Hand.',
                        co2: '0.5 kg CO‚ÇÇ'
                    },
                    {
                        question: 'Aus welcher Region kommt traditionell der beste Arabica-Kaffee?',
                        options: ['√Ñthiopien', 'Schweden', 'Japan', 'Frankreich'],
                        correctCountry: '√Ñthiopien',
                        coordinates: { x: 56, y: 48 },
                        fact: '√Ñthiopien ist die Geburtsst√§tte des Kaffees! Hier w√§chst Kaffee noch wild im Hochland.',
                        co2: '0.3 kg CO‚ÇÇ'
                    },
                    {
                        question: 'In welchem Land wird der Kaffee oft f√ºr Europa ger√∂stet?',
                        options: ['Deutschland', 'Thailand', 'Chile', 'Kanada'],
                        correctCountry: 'Deutschland',
                        coordinates: { x: 50, y: 26 },
                        fact: 'Deutschland ist Europas gr√∂√üter Kaffeer√∂ster. Beim R√∂sten entwickelt sich erst das typische Kaffeearoma!',
                        co2: '0.6 kg CO‚ÇÇ'
                    }
                ],
                route: [
                    { x: 32, y: 58 }, // Brasilien
                    { x: 56, y: 48 }, // √Ñthiopien
                    { x: 50, y: 26 }, // Deutschland
                    { x: 50, y: 28 }  // Schweiz
                ]
            },
            sneakers: {
                name: 'Sneakers',
                icon: 'üëü',
                color: '#EF4444',
                questions: [
                    {
                        question: 'Wo wird Naturkautschuk f√ºr Schuhsohlen haupts√§chlich gewonnen?',
                        options: ['Malaysia', '√ñsterreich', 'Polen', 'Irland'],
                        correctCountry: 'Malaysia',
                        coordinates: { x: 70, y: 50 },
                        fact: 'Malaysia ist einer der gr√∂√üten Kautschuk-Produzenten. Kautschuk kommt vom Gummibaum und wird f√ºr flexible Sohlen verwendet.',
                        co2: '3.2 kg CO‚ÇÇ'
                    },
                    {
                        question: 'In welchem Land werden die meisten Sportschuhe produziert?',
                        options: ['Vietnam', 'D√§nemark', 'Marokko', 'T√ºrkei'],
                        correctCountry: 'Vietnam',
                        coordinates: { x: 70, y: 44 },
                        fact: 'Vietnam produziert fast ein Drittel aller Schuhe weltweit! Ein Sneaker durchl√§uft √ºber 360 Arbeitsschritte.',
                        co2: '4.5 kg CO‚ÇÇ'
                    },
                    {
                        question: 'Wo werden synthetische Materialien f√ºr Sneakers oft hergestellt?',
                        options: ['China', 'Belgien', 'Neuseeland', 'Kenia'],
                        correctCountry: 'China',
                        coordinates: { x: 72, y: 34 },
                        fact: 'China produziert die meisten synthetischen Materialien. Ein moderner Sneaker besteht aus √ºber 65 verschiedenen Teilen!',
                        co2: '5.8 kg CO‚ÇÇ'
                    }
                ],
                route: [
                    { x: 70, y: 50 }, // Malaysia
                    { x: 70, y: 44 }, // Vietnam
                    { x: 72, y: 34 }, // China
                    { x: 50, y: 28 }  // Schweiz
                ]
            }
        };

        // Country positions on improved world map
        const countries = {
            'Indien': { x: 64, y: 38, label: 'Indien' },
            'China': { x: 72, y: 34, label: 'China' },
            'Bangladesh': { x: 67, y: 40, label: 'Bangladesh' },
            'Kongo': { x: 52, y: 52, label: 'Kongo' },
            'Taiwan': { x: 74, y: 42, label: 'Taiwan' },
            'Brasilien': { x: 32, y: 58, label: 'Brasilien' },
            '√Ñthiopien': { x: 56, y: 48, label: '√Ñthiopien' },
            'Deutschland': { x: 50, y: 26, label: 'Deutschland' },
            'Malaysia': { x: 70, y: 50, label: 'Malaysia' },
            'Vietnam': { x: 70, y: 44, label: 'Vietnam' },
            'Schweiz': { x: 50, y: 28, label: 'Schweiz' },
            'USA': { x: 18, y: 32, label: 'USA' },
            'Japan': { x: 78, y: 36, label: 'Japan' }
        };

        function renderMenu() {
            return `
                <div class="container mx-auto px-4 py-8">
                    <div class="max-w-4xl mx-auto text-center">
                        <div class="text-6xl mb-6 animate-bounce">üåç</div>
                        <h1 class="text-5xl font-bold text-gray-800 mb-4">
                            Globalisierungs-Quiz
                        </h1>
                        <p class="text-xl text-gray-600 mb-8">
                            Ziehe die Produkte auf die richtige Position auf der Weltkarte!
                        </p>
                        
                        <div class="bg-white rounded-xl p-6 shadow-lg mb-8">
                            <h2 class="text-2xl font-bold mb-4 text-gray-800">Wie wird gespielt?</h2>
                            <div class="grid md:grid-cols-3 gap-4 text-left">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <div class="text-3xl mb-2">1Ô∏è‚É£</div>
                                    <p class="font-semibold mb-1">W√§hle ein Produkt</p>
                                    <p class="text-sm text-gray-600">Klicke auf ein Produkt unten</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <div class="text-3xl mb-2">2Ô∏è‚É£</div>
                                    <p class="font-semibold mb-1">Beantworte Fragen</p>
                                    <p class="text-sm text-gray-600">Klicke das richtige Land auf der Karte an</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <div class="text-3xl mb-2">3Ô∏è‚É£</div>
                                    <p class="font-semibold mb-1">Sammle Punkte</p>
                                    <p class="text-sm text-gray-600">Jede richtige Antwort = 100 Punkte!</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-r from-yellow-100 to-orange-100 rounded-xl p-4 mb-8">
                            <p class="text-lg font-semibold text-gray-800 flex items-center justify-center gap-2">
                                <span>‚ù§Ô∏è</span>
                                <span>Du hast ${gameState.lives} Leben</span>
                                <span>|</span>
                                <span>üéØ</span>
                                <span>Aktueller Score: ${gameState.score}</span>
                            </p>
                        </div>

                        <h2 class="text-2xl font-bold mb-6 text-gray-800">W√§hle ein Produkt:</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            ${Object.entries(products).map(([key, product]) => `
                                <button
                                    onclick="startProduct('${key}')"
                                    class="p-6 rounded-xl text-white font-bold text-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all"
                                    style="background-color: ${product.color}"
                                >
                                    <div class="text-5xl mb-2">${product.icon}</div>
                                    <div>${product.name}</div>
                                    <div class="text-sm mt-2 opacity-90">${product.questions.length} Fragen</div>
                                </button>
                            `).join('')}
                        </div>

                        ${gameState.correctAnswers > 0 ? `
                            <div class="mt-8 bg-green-50 rounded-xl p-6">
                                <h3 class="text-xl font-bold text-green-800 mb-2">üéâ Fortschritt</h3>
                                <p class="text-gray-700">
                                    Du hast bisher ${gameState.correctAnswers} Fragen richtig beantwortet!
                                </p>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function renderGame() {
            const product = products[gameState.currentProduct];
            const question = product.questions[gameState.currentQuestionIndex];
            
            return `
                <div class="container mx-auto px-4 py-8">
                    <div class="max-w-6xl mx-auto">
                        <!-- Header -->
                        <div class="bg-white rounded-xl p-4 shadow-lg mb-6">
                            <div class="flex items-center justify-between">
                                <button onclick="backToMenu()" class="text-gray-600 hover:text-gray-800 flex items-center gap-2">
                                    <span>‚Üê</span> Zur√ºck
                                </button>
                                <div class="flex items-center gap-6">
                                    <div class="flex items-center gap-2">
                                        <span>‚ù§Ô∏è</span>
                                        <span class="font-bold">${'‚ù§Ô∏è'.repeat(gameState.lives)}</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span>‚≠ê</span>
                                        <span class="font-bold">${gameState.score}</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Product Info -->
                        <div class="bg-white rounded-xl p-6 shadow-lg mb-6" style="border-left: 4px solid ${product.color}">
                            <div class="flex items-center gap-4">
                                <div class="text-5xl">${product.icon}</div>
                                <div>
                                    <h2 class="text-2xl font-bold text-gray-800">${product.name}</h2>
                                    <p class="text-gray-600">Frage ${gameState.currentQuestionIndex + 1} von ${product.questions.length}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Question -->
                        <div class="bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl p-8 shadow-lg mb-6 text-white">
                            <h3 class="text-3xl font-bold mb-4">${question.question}</h3>
                            <p class="text-lg opacity-90">Klicke auf das richtige Land auf der Weltkarte!</p>
                            ${gameState.showHint ? `
                                <div class="mt-4 bg-white bg-opacity-20 rounded-lg p-4">
                                    <p class="text-sm">üí° Tipp: Suche nach <strong>${question.correctCountry}</strong></p>
                                </div>
                            ` : `
                                <button onclick="showHint()" class="mt-4 bg-white bg-opacity-20 hover:bg-opacity-30 px-4 py-2 rounded-lg text-sm">
                                    üí° Tipp anzeigen (-25 Punkte)
                                </button>
                            `}
                        </div>

                        <!-- World Map -->
                        <div class="bg-gradient-to-br from-blue-100 to-green-100 rounded-xl p-6 shadow-lg">
                            <svg id="worldMap" viewBox="0 0 100 70" xmlns="http://www.w3.org/2000/svg" class="w-full h-auto">
                                <!-- Ocean background -->
                                <rect width="100" height="70" fill="#DBEAFE"/>
                                
                                <!-- More realistic continents -->
                                
                                <!-- North America -->
                                <path d="M 8 18 L 10 15 L 14 14 L 18 16 L 22 18 L 24 22 L 26 28 L 28 35 L 26 40 L 22 42 L 18 41 L 14 38 L 10 35 L 8 28 Z" 
                                    fill="#86EFAC" stroke="#059669" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Central America -->
                                <path d="M 22 42 L 24 44 L 26 45 L 24 42 Z" 
                                    fill="#86EFAC" stroke="#059669" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- South America -->
                                <path d="M 26 45 L 30 46 L 33 50 L 35 55 L 36 60 L 35 65 L 32 67 L 28 66 L 26 62 L 25 56 L 26 50 Z" 
                                    fill="#86EFAC" stroke="#059669" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Europe -->
                                <path d="M 46 22 L 48 20 L 52 21 L 55 23 L 56 26 L 54 29 L 52 31 L 48 30 L 46 27 Z" 
                                    fill="#FCD34D" stroke="#F59E0B" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Africa -->
                                <path d="M 47 32 L 50 30 L 53 31 L 56 33 L 58 38 L 59 45 L 58 52 L 56 58 L 53 61 L 50 60 L 48 56 L 47 50 L 46 42 L 47 36 Z" 
                                    fill="#FCD34D" stroke="#F59E0B" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Asia -->
                                <path d="M 56 18 L 62 16 L 68 17 L 74 19 L 78 22 L 80 26 L 82 32 L 82 38 L 80 42 L 76 45 L 72 46 L 68 44 L 64 40 L 60 36 L 58 30 L 57 24 Z" 
                                    fill="#FCA5A5" stroke="#DC2626" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Middle East / India region -->
                                <path d="M 58 30 L 62 32 L 66 35 L 68 40 L 67 44 L 64 46 L 60 44 L 58 40 L 58 35 Z" 
                                    fill="#FCA5A5" stroke="#DC2626" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Southeast Asia -->
                                <path d="M 68 44 L 72 45 L 74 48 L 72 52 L 69 53 L 67 50 L 68 47 Z" 
                                    fill="#FCA5A5" stroke="#DC2626" stroke-width="0.3" opacity="0.9"/>
                                
                                <!-- Australia -->
                                <path d="M 74 54 L 78 55 L 82 57 L 84 60 L 82 63 L 78 64 L 74 62 L 72 59 L 72 56 Z" 
                                    fill="#A78BFA" stroke="#7C3AED" stroke-width="0.3" opacity="0.9"/>

                                <!-- Country Markers with stable positioning -->
                                ${Object.entries(countries).map(([name, pos]) => `
                                    <g class="country-marker" onclick="selectCountry('${name}')">
                                        <circle cx="${pos.x}" cy="${pos.y}" r="2" fill="${product.color}" stroke="white" stroke-width="0.5" opacity="0.9"/>
                                        <text class="country-label" x="${pos.x}" y="${pos.y - 3.5}" 
                                            font-size="2.5" 
                                            fill="#1F2937" 
                                            text-anchor="middle"
                                            font-weight="600"
                                            style="paint-order: stroke; stroke: white; stroke-width: 0.3px;">
                                            ${pos.label}
                                        </text>
                                    </g>
                                `).join('')}

                                <!-- Switzerland Marker (Special) -->
                                <g>
                                    <circle cx="50" cy="28" r="2.5" fill="#EF4444" stroke="white" stroke-width="0.7" opacity="1"/>
                                    <text x="50" y="24" font-size="3" fill="#EF4444" text-anchor="middle" font-weight="bold">üá®üá≠</text>
                                </g>
                            </svg>
                        </div>

                        <!-- Options as buttons (fallback for mobile) -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-6">
                            ${question.options.map(option => `
                                <button
                                    onclick="selectCountry('${option}')"
                                    class="bg-white hover:bg-gray-50 border-2 border-gray-300 hover:border-blue-500 rounded-lg p-4 font-semibold text-gray-700 transition-all"
                                >
                                    ${option}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderResult(isCorrect, question) {
            const product = products[gameState.currentProduct];
            
            return `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-3xl p-8 max-w-2xl w-full shadow-2xl ${isCorrect ? 'celebration' : ''}">
                        <div class="text-center">
                            <div class="text-8xl mb-4">${isCorrect ? 'üéâ' : 'üòÖ'}</div>
                            <h2 class="text-4xl font-bold mb-4 ${isCorrect ? 'text-green-600' : 'text-orange-600'}">
                                ${isCorrect ? 'Richtig!' : 'Nicht ganz!'}
                            </h2>
                            
                            ${isCorrect ? `
                                <div class="text-2xl font-bold text-green-600 mb-4">
                                    +${gameState.showHint ? '75' : '100'} Punkte!
                                </div>
                            ` : `
                                <div class="text-lg text-gray-600 mb-4">
                                    Die richtige Antwort war: <strong>${question.correctCountry}</strong>
                                </div>
                            `}

                            <div class="bg-blue-50 rounded-xl p-6 mb-6 text-left">
                                <p class="text-lg font-semibold mb-2">üí° Wusstest du?</p>
                                <p class="text-gray-700">${question.fact}</p>
                                <div class="mt-3 text-sm text-gray-600">
                                    <span class="font-semibold">CO‚ÇÇ-Ausstoss in diesem Schritt:</span> ${question.co2}
                                </div>
                            </div>

                            ${gameState.currentQuestionIndex < product.questions.length - 1 ? `
                                <button
                                    onclick="nextQuestion()"
                                    class="w-full py-4 px-8 rounded-xl text-white font-bold text-xl shadow-lg hover:shadow-xl transition-all"
                                    style="background-color: ${product.color}"
                                >
                                    N√§chste Frage ‚Üí
                                </button>
                            ` : `
                                <button
                                    onclick="finishProduct()"
                                    class="w-full py-4 px-8 rounded-xl text-white font-bold text-xl shadow-lg hover:shadow-xl transition-all"
                                    style="background-color: ${product.color}"
                                >
                                    ${product.name} abgeschlossen! üéä
                                </button>
                            `}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderFinalResult() {
            const product = products[gameState.currentProduct];
            const totalQuestions = product.questions.length;
            const correctInThisRound = gameState.correctAnswers;
            const percentage = Math.round((correctInThisRound / totalQuestions) * 100);
            
            return `
                <div class="container mx-auto px-4 py-8">
                    <div class="max-w-3xl mx-auto">
                        <div class="bg-white rounded-3xl p-12 shadow-2xl text-center">
                            <div class="text-7xl mb-6">üèÜ</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">
                                ${product.name} abgeschlossen!
                            </h2>
                            
                            <div class="bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-2xl p-8 mb-8">
                                <div class="grid grid-cols-3 gap-4">
                                    <div>
                                        <p class="text-sm opacity-90 mb-1">Punkte</p>
                                        <p class="text-4xl font-bold">${gameState.score}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm opacity-90 mb-1">Richtig</p>
                                        <p class="text-4xl font-bold">${correctInThisRound}/${totalQuestions}</p>
                                    </div>
                                    <div>
                                        <p class="text-sm opacity-90 mb-1">Genauigkeit</p>
                                        <p class="text-4xl font-bold">${percentage}%</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-yellow-50 border-2 border-yellow-300 rounded-xl p-6 mb-8">
                                <p class="text-lg font-semibold mb-2">üåç Die Reise im √úberblick</p>
                                <div class="text-left space-y-2 text-sm text-gray-700">
                                    ${product.questions.map((q, idx) => `
                                        <div class="flex items-center gap-2">
                                            <span>${idx + 1}.</span>
                                            <span>${q.correctCountry}</span>
                                            <span class="text-gray-500">(${q.co2})</span>
                                        </div>
                                    `).join('')}
                                    <div class="flex items-center gap-2 font-bold text-red-600">
                                        <span>‚Üí</span>
                                        <span>üá®üá≠ Schweiz</span>
                                    </div>
                                </div>
                            </div>

                            ${percentage === 100 ? `
                                <div class="bg-green-50 rounded-xl p-6 mb-8">
                                    <p class="text-2xl font-bold text-green-600 mb-2">üåü Perfekt!</p>
                                    <p class="text-gray-700">Du bist ein Globalisierungs-Experte! Alle Fragen richtig beantwortet!</p>
                                </div>
                            ` : percentage >= 66 ? `
                                <div class="bg-blue-50 rounded-xl p-6 mb-8">
                                    <p class="text-2xl font-bold text-blue-600 mb-2">üëè Super!</p>
                                    <p class="text-gray-700">Sehr gut! Du kennst dich schon gut mit globalen Lieferketten aus!</p>
                                </div>
                            ` : `
                                <div class="bg-orange-50 rounded-xl p-6 mb-8">
                                    <p class="text-2xl font-bold text-orange-600 mb-2">üí™ Weiter so!</p>
                                    <p class="text-gray-700">Guter Start! Probiere weitere Produkte aus, um mehr zu lernen!</p>
                                </div>
                            `}

                            <button
                                onclick="backToMenu()"
                                class="w-full py-4 px-8 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-bold text-xl rounded-xl shadow-lg transition-all"
                            >
                                Weiterspielen
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function startProduct(productKey) {
            gameState.currentProduct = productKey;
            gameState.currentQuestionIndex = 0;
            gameState.gameMode = 'playing';
            gameState.showHint = false;
            gameState.correctAnswers = 0;
            render();
        }

        function selectCountry(countryName) {
            const product = products[gameState.currentProduct];
            const question = product.questions[gameState.currentQuestionIndex];
            const isCorrect = countryName === question.correctCountry;
            
            if (isCorrect) {
                gameState.score += gameState.showHint ? 75 : 100;
                gameState.correctAnswers++;
            } else {
                gameState.lives--;
                if (gameState.lives <= 0) {
                    alert('Game Over! Du hast keine Leben mehr.');
                    resetGame();
                    return;
                }
            }
            
            gameState.gameMode = 'result';
            gameState.lastAnswer = { isCorrect, question };
            render();
        }

        function showHint() {
            gameState.showHint = true;
            render();
        }

        function nextQuestion() {
            gameState.currentQuestionIndex++;
            gameState.gameMode = 'playing';
            gameState.showHint = false;
            render();
        }

        function finishProduct() {
            gameState.gameMode = 'final';
            render();
        }

        function backToMenu() {
            gameState.gameMode = 'menu';
            gameState.currentProduct = null;
            render();
        }

        function resetGame() {
            gameState = {
                currentLevel: 0,
                score: 0,
                lives: 3,
                correctAnswers: 0,
                currentProduct: null,
                difficulty: 'easy',
                gameMode: 'menu',
                currentQuestionIndex: 0,
                showHint: false
            };
            render();
        }

        function render() {
            const app = document.getElementById('app');
            
            if (gameState.gameMode === 'menu') {
                app.innerHTML = renderMenu();
            } else if (gameState.gameMode === 'playing') {
                app.innerHTML = renderGame();
            } else if (gameState.gameMode === 'result') {
                const gameHTML = renderGame();
                const resultHTML = renderResult(gameState.lastAnswer.isCorrect, gameState.lastAnswer.question);
                app.innerHTML = gameHTML + resultHTML;
            } else if (gameState.gameMode === 'final') {
                app.innerHTML = renderFinalResult();
            }
        }

        // Initial render
        render();
    </script>
</body>
</html>
